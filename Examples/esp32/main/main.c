#include <stdio.h>
#include <stdbool.h>
#include <unistd.h>
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "ssd1306.h"

// 'logo', 57x60px
const unsigned char logo [] = {
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0xff, 0xff, 0xf8, 0x00, 0x1f, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xc0, 0x00, 0x07, 0xff, 0xff, 0x80, 0xff, 0xff, 0x00, 0x00, 0x07, 0xff, 0xff, 0x80,
	0xff, 0xfc, 0x00, 0x00, 0x07, 0xff, 0xff, 0x80, 0xff, 0xf8, 0x00, 0x00, 0x07, 0xdf, 0xff, 0x80,
	0xff, 0xf0, 0x00, 0x00, 0x07, 0xc7, 0xff, 0x80, 0xff, 0xc0, 0x00, 0x00, 0x07, 0xc3, 0xff, 0x80,
	0xff, 0x80, 0x00, 0x00, 0x07, 0xc1, 0xff, 0x80, 0xff, 0x80, 0x00, 0x00, 0x07, 0xc0, 0xff, 0x80,
	0xff, 0x00, 0x00, 0x00, 0x07, 0xc0, 0xff, 0x80, 0xfe, 0x00, 0x00, 0x00, 0x07, 0xc0, 0x7f, 0x80,
	0xfc, 0x00, 0x00, 0x3c, 0x07, 0xc0, 0x3f, 0x80, 0xfc, 0x00, 0x01, 0xff, 0xc7, 0xc0, 0x1f, 0x80,
	0xf8, 0x00, 0x07, 0xff, 0xf7, 0xc0, 0x1f, 0x80, 0xf8, 0x00, 0x0f, 0xff, 0xff, 0xc0, 0x0f, 0x80,
	0xf0, 0x00, 0x1f, 0xff, 0xff, 0xc0, 0x0f, 0x80, 0xf0, 0x00, 0x3f, 0xff, 0xff, 0xc0, 0x0f, 0x80,
	0xf0, 0x00, 0x7f, 0xff, 0xff, 0xc0, 0x07, 0x80, 0xe0, 0x00, 0xff, 0xff, 0xff, 0xc0, 0x07, 0x80,
	0xe0, 0x00, 0xff, 0x81, 0xff, 0xc0, 0x07, 0x80, 0xe0, 0x01, 0xff, 0x00, 0x7f, 0xc0, 0x07, 0x80,
	0xe0, 0x01, 0xfe, 0x00, 0x3f, 0xc0, 0x03, 0x80, 0xe0, 0x01, 0xfc, 0x00, 0x3f, 0xc0, 0x03, 0x80,
	0xe0, 0x01, 0xfc, 0x00, 0x1f, 0xc0, 0x03, 0x80, 0xc0, 0x01, 0xfc, 0x00, 0x1f, 0xc0, 0x03, 0x80,
	0xc0, 0x01, 0xfc, 0x00, 0x1f, 0xc0, 0x03, 0x80, 0xc0, 0x01, 0xfc, 0x00, 0x1f, 0xc0, 0x03, 0x80,
	0xe0, 0x01, 0xfc, 0x00, 0x3f, 0xc0, 0x03, 0x80, 0xe0, 0x01, 0xfc, 0x00, 0x3f, 0xc0, 0x03, 0x80,
	0xe0, 0x01, 0xfe, 0x00, 0x7f, 0x80, 0x03, 0x80, 0xe0, 0x01, 0xff, 0x00, 0xff, 0x80, 0x07, 0x80,
	0xe0, 0x01, 0xff, 0xc3, 0xff, 0x80, 0x07, 0x80, 0xf0, 0x01, 0xff, 0xff, 0xff, 0x00, 0x07, 0x80,
	0xf0, 0x01, 0xff, 0xff, 0xfe, 0x00, 0x07, 0x80, 0xf0, 0x01, 0xff, 0xff, 0xfc, 0x00, 0x0f, 0x80,
	0xf8, 0x01, 0xff, 0xff, 0xf8, 0x00, 0x0f, 0x80, 0xf8, 0x01, 0xff, 0xff, 0xf0, 0x00, 0x1f, 0x80,
	0xfc, 0x01, 0xf3, 0xff, 0xc0, 0x00, 0x1f, 0x80, 0xfc, 0x01, 0xf0, 0xff, 0x00, 0x00, 0x3f, 0x80,
	0xfe, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x3f, 0x80, 0xfe, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x7f, 0x80,
	0xff, 0x01, 0xf0, 0x00, 0x00, 0x00, 0xff, 0x80, 0xff, 0x81, 0xf0, 0x00, 0x00, 0x01, 0xff, 0x80,
	0xff, 0xc1, 0xf0, 0x00, 0x00, 0x03, 0xff, 0x80, 0xff, 0xe1, 0xf0, 0x00, 0x00, 0x03, 0xff, 0x80,
	0xff, 0xf1, 0xf0, 0x00, 0x00, 0x0f, 0xff, 0x80, 0xff, 0xff, 0xf0, 0x00, 0x00, 0x1f, 0xff, 0x80,
	0xff, 0xff, 0xf0, 0x00, 0x00, 0x7f, 0xff, 0x80, 0xff, 0xff, 0xf0, 0x00, 0x01, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xf0, 0x00, 0x07, 0xff, 0xff, 0x80, 0xff, 0xff, 0xfe, 0x00, 0x7f, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80,
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80
};

void app_main(void)
{
	ssd1306_init();

	ssd1306_fill(ssd1306_color_white);
	ssd1306_draw_bitmap(35, 2, logo, 57, 60, ssd1306_color_black);
	ssd1306_update_screen();
	vTaskDelay(2000 / portTICK_PERIOD_MS);
	ssd1306_toggle_invert();
	ssd1306_update_screen();
	vTaskDelay(2000 / portTICK_PERIOD_MS);
	ssd1306_toggle_invert();
	ssd1306_clear();

	ssd1306_goto_xy(36, 10);
	ssd1306_puts("HELLO", &Font_11x18, 1);
	ssd1306_goto_xy(31, 35);
	ssd1306_puts("WORLD!", &Font_11x18, 1);
	ssd1306_update_screen();

	ssd1306_scroll_right(0, 63);
	vTaskDelay(2000 / portTICK_PERIOD_MS);

	ssd1306_scroll_left(0, 63);
	vTaskDelay(2000 / portTICK_PERIOD_MS);

	ssd1306_stop_scroll();

    while (true)
    {
    	vTaskDelay(2000 / portTICK_PERIOD_MS);
    }
}
